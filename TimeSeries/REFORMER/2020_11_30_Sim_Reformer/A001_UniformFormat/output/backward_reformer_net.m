function [y1] = backward_reformer_net(x1)
%BACKWARD_REFORMER_NET neural network simulation function.
%
% Auto-generated by MATLAB, 25-Feb-2022 07:45:21.
% 
% [y1] = backward_reformer_net(x1) takes these arguments:
%   x = 7xQ matrix, input #1
% and returns:
%   y = 2xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [500.019651460741;1.01283162009754e-06;0;0;0.00964536350239163;0;2.71274351238288e-05];
x1_step1.gain = [0.00500055441327779;5.85503115269372;2.52831436539074;5.35104689931391;15.9229077269538;4.32120644350272;2.71977616147316];
x1_step1.ymin = -1;

% Layer 1
b1 = [1.3968507087949102452;-1.985169036802575393;-0.57045450460593494224;0.015041773796753041617;-2.1737116117632391266;-1.2150421883316231408;2.0348478069433024729;1.4875733930993058074];
IW1_1 = [0.00048842081537334852692 -0.043169777315469261281 1.2808054048381460888 0.62919622413780540438 -0.56879461082445459397 0.53799967294447581523 1.052545402237373473;-0.029289340145446849523 -0.59563647661465835004 0.21275120028053687293 0.014766643542069282993 -0.85560891143104311762 0.060965437224379609438 -0.008937402646151627536;0.25454929155248168238 -0.38683524411173547675 -0.32663594355829700389 -0.010751965066781799321 0.45178697179259097449 0.043268457120423507722 -0.21352615457669724131;0.22835098321069885463 -0.13096506973580859801 0.21236071055192851098 0.22690950599997844472 0.50662649066673948184 0.33546535443144104294 0.29585868769678197454;-0.00097445668196983266547 -1.1434583435304246368 1.9190620295243414617 1.085557461109423194 -1.9168302016946188182 0.77521003348824435442 0.47987063520853062704;0.003011207502920562086 -0.74591044207773415931 -0.26000042030821185479 -0.027143642193880379576 -0.65411787388768516394 -0.099240135643452923042 -0.86593193758532660542;0.0058137973525016622967 0.65498925682349640187 -0.075428568475253018888 -0.018216912992524755127 0.97480760760191920156 0.30985567662191493277 0.044826804386725128959;0.0025794433907167912262 -0.10633232449206500569 0.90831089446844526236 0.54062832851987163707 -0.26850551529367583381 0.64036793736191677251 0.25702602482334657719];

% Layer 2
b2 = [-2.0924393459012886609;0.28711966379373532465;0.077173293232977294154;-0.49680736424809596175;-1.0560815525929696523];
IW2_1 = [0.020721962526836387036 -1.100762551297596481 0.62749528119541408966 0.39227977227259047677 -1.6715219226912365613 -0.38356653448508648552 0.2297326707465152662;-0.0090454403074716072802 0.44438325361058755858 0.47739571883501336069 0.24834607638747244196 0.45716946540597930282 0.53283146186357943641 0.30181002957175295798;0.29687942408876361045 0.27444885990921019658 -0.027376450564088702921 0.039688946443072720127 0.73892165096344575304 0.036807380316871571302 -0.59062162827045705527;-0.0057562229548471285229 -0.23863455463254262812 0.085476071347570362069 0.10521969067215988791 -0.36271664933121727792 -0.025683166922748301708 -0.060340058381908999452;-0.01324071614904244118 -0.56111322358629567297 0.58165547300502373762 0.3097074255127924558 -1.0667451283102429294 -0.12650589041772736243 0.29685581963554280582];
LW2_1 = [0.56555190498062624105 0.50296218320351049336 0.23854120015671476107 -0.31357383662565274651 2.7008885163942739638 0.80245963808789999572 -0.39323197447120672443 0.86833931957873677909;0.24584651483997888022 0.15628954277898490788 -0.32881221760086792871 0.41139276018877007912 -0.53502201717959052552 -0.52661952745562434774 0.58823956691962830945 -0.435049981742624714;0.65682911398128274172 -0.43666348728045301097 0.49643188686929873299 -0.29029914378194049407 -0.8456558569633731981 -0.23891181185326107461 0.29382403818611213531 0.55755716956411272012;0.74377964398336215979 -0.94508037402852884679 -0.0035457934603629784158 0.072837400541402974596 0.090855870536352814626 -0.46183119413803364051 -0.77174248676106371736 -0.058493971169551399469;0.37679804929370741551 0.21873274379931462175 -0.51166970383185783611 0.64589073553338260947 1.1087722402551336565 0.49384516999072153309 -0.34373609504875779486 0.70958910939684038954];

% Layer 3
b3 = [1.4578859504123329316;0.59654812897852382836;1.5603199968509753326];
IW3_1 = [-0.15572845744928834333 0.38907542260870320305 0.37558098380373944325 0.24549063643120747069 0.23899259311438686426 0.089349522994905894446 0.10034078019403337712;-0.00067028558843931231558 -0.18914372472417118054 -0.14354428297469354336 -0.16892825563539765055 -0.45056341655037945859 -0.45491792120440699421 0.45326646650879481859;-0.0092378420207855152513 -0.058286468911433284013 0.13473990350183845388 0.058622362344731816786 0.013627405321724773979 0.2393614129091932996 -0.17516901697936596016];
LW3_1 = [0.34053813790763437508 1.1493839915457044754 -0.21216196692198843743 0.58986254951431105198 0.26704239780493738143 -0.18412853425483358127 0.46574111148429780949 -0.55561176295982284135;-1.2002972227487234136 -0.36405110246742411473 0.095417551054872526417 -0.1334819061828934339 -0.2643727529023814915 0.61623968346481627911 -0.87881526097900841688 0.18818664435393947509;0.23622819214294715762 -0.1745071854514113896 -0.29587899673317191729 0.32669477349327658011 -0.17629147493258082169 0.50089741131630871607 -0.62016840041666376759 -0.88469439536772476185];
LW3_2 = [-0.10326941472674477929 -0.42877652155875928264 0.27070497344822980201 0.11679787696771039285 0.072146052966374191184;-0.51448957605383249803 1.0915334255383506434 -0.00693165343751727097 0.21271734252240404039 -0.78939554169896386515;-0.54634133713576660263 -0.026378274894917071169 0.027581208199063841219 0.78767782685709697432 0.8053091511436288874];

% Layer 4
b4 = [1.3691352693463600954;0.27514937051881949159];
IW4_1 = [0.14837472945020016568 -0.63724730124975770273 -0.25798696025307976676 -0.19234853281512648282 -0.65216050960351723553 -0.20970113065412462894 0.028479994889956578713;0.15681683639497473459 -0.059018694533634209753 -0.84678843224680200308 -0.44474263947172826272 0.65872386899161383678 0.29308249392129165356 -0.99183130626678961406];
LW4_1 = [-1.1961126969026558697 -0.6411011718885263333 0.33935021995628195102 -0.72965071024728211935 -0.39033722606622889284 0.094872183974607324219 -0.01843971492891353578 0.67905197711903009239;1.5961348736579141772 -1.0784775847286125483 -0.38221074179816649785 0.091066086481499955441 1.1736214031976095473 0.40176794223920420102 1.0941501384073153424 -0.67979257618989352707];
LW4_2 = [3.1878626634586972877 -0.081734069129878267335 -0.24009144052202713304 0.088924493321890604736 1.3381812906377192895;-1.1949120073738777048 -1.3550812806241949726 -0.31323238563311706084 0.24337709712374802629 -0.5122724753812323284];
LW4_3 = [0.91929943484611342797 1.0139504104239376314 0.21725197207554020062;1.1573608430072424014 -2.625999077425741568 -1.099302844185151784];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.333339209769731;0.571608550105375];
y1_step1.xoffset = [0;0];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + IW2_1*xp1 + LW2_1*a1);

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + IW3_1*xp1 + LW3_1*a1 + LW3_2*a2);

% Layer 4
a4 = repmat(b4,1,Q) + IW4_1*xp1 + LW4_1*a1 + LW4_2*a2 + LW4_3*a3;

% Output 1
y1 = mapminmax_reverse(a4,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
