function [y1] = forward_reformer_net(x1)
%FORWARD_REFORMER_NET neural network simulation function.
%
% Auto-generated by MATLAB, 25-Feb-2022 07:54:00.
% 
% [y1] = forward_reformer_net(x1) takes these arguments:
%   x = 3xQ matrix, input #1
% and returns:
%   y = 8xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [500.019651460741;0;0];
x1_step1.gain = [0.00500055441327779;0.333339209769731;0.571608550105375];
x1_step1.ymin = -1;

% Layer 1
b1 = [-4.0747054273851812667;2.0535888026421917907;-1.75817381642009396];
IW1_1 = [-0.037383055435642909003 -2.1608211352419286477 -1.0596576994108761749;-0.99287019694268319192 0.79420885371179494872 1.9017787428812256145;-1.414782015070514154 -0.12656449671890349085 0.22875349962733734777];

% Layer 2
b2 = [3.5015007392221453308;-0.11232287444806052235;-0.40991319975267492826;-0.92972071249747334498;0.9052248004573687501];
IW2_1 = [-0.29647538177536369997 -0.44552140058320505167 -0.77745490343847156733;-0.013122846180398568122 0.66022202193071766185 -0.037984767735523186638;-3.2135201238378958699 -1.2089411240547001114 -2.4661558329334862805;0.023723164028617630544 -0.83647056676729825142 -1.1237559073286074174;1.2722233610823339145 0.57234531302858049351 0.21350279333115909641];
LW2_1 = [3.7875766637763677025 -0.008945677672391981472 0.24180302686890131625;-1.503754624088749603 -0.0370359632680437173 -0.083421214999601298046;1.4035891547292451698 -2.3288482311251601509 -2.3403198819421175969;1.7096776090827632277 0.04645334971516973388 0.072185777267108411359;-2.2109331552363711282 -0.16554648355618858946 0.77469041597117194176];

% Layer 3
b3 = [1.8497844633915045964;-0.19331325242234775885;-1.5029289631473219391;-0.69619186186391679438;0.911682249289832769;0.18018884818057365194;-0.58361100321664272084;0.04156210718704899526];
IW3_1 = [-0.22809740306379794328 0.95155376946107661507 -0.14438080268516317872;0.76371170731061466252 0.13287341001584102029 0.011475354495686842377;0.86120298490582558593 0.14016150929615558973 0.02845399596275386897;0.036727739869466757838 -0.82844377599293461678 -0.32287074513156488464;0.25938627231942290585 -0.060982682910055860392 -0.14726897816932305041;-0.5725196804548465801 -0.01630285900447762254 0.13357299897330263128;0.18421625376935632512 0.40593425238344893469 0.50122083646027104642;-0.046360953190572221083 -0.14010815153525496557 -0.050953765649818807959];
LW3_1 = [-0.10267581632408828707 -0.28831791348315521928 -0.54629306614435746425;-0.29762505002301031798 -0.16616076015004507815 -0.062279659995778502424;0.48036723036996276104 -0.18245398317724204063 0.65130635206326137343;0.81603241657456759839 0.00082229520207705909286 -0.0084699543447987642175;-0.86315662221694178236 -0.0097906330623219756798 0.15395981456634247331;0.32781303129817745967 0.31572103825399944199 0.18308871885783895017;-1.3576425139827525967 0.107281601401271659 -0.032935137876552778025;1.7152169253765601198 0.091214253708908704654 0.13746313934582865546];
LW3_2 = [0.33857317495922067963 -0.58331396055385908994 -0.024729693213448450395 0.57319916793815706146 1.0345218579932626835;0.05485537507006411212 -0.56912121451213670831 -0.24227319912545947078 -0.92547921324685278321 -1.4135210465990082351;-0.31423829689337079429 -0.68543823288226446433 -0.29722445669484992559 -1.4809094549125612073 2.2880408168844224015;0.083812455866405399796 0.00021221210578384504253 -0.0018599751969596287678 0.38499166312370647347 0.022105100441672340117;0.35987647039220893586 0.44616803220863954227 0.19258579459385458121 1.8743617126092761982 -0.0051688527539682001949;-0.25546591624067499504 -0.46585811711992153317 0.18219098600666994159 0.15049450849286336029 1.3880629701659048525;-0.84321611651479377869 -1.1813965465042446379 -0.17090237360684509826 -1.4425023121835198747 -3.3220113443549514898;-0.48727120223435949065 -0.62299834041654988948 -0.27353810253563481947 -1.4596087315022785447 1.0501172094096518084];

% Layer 4
b4 = [-1.3576573675779115558;1.3046898392772812159;-1.4145972488083524699;0.36418928813604134476;0.47998952847028641955;-0.34839545425333567907;-1.5516590740398874537;0.37212496575578202229];
IW4_1 = [0.13262037244723598461 0.094875632593341432952 -0.80239084747452926738;0.98975681443769980561 0.46070559435668401171 0.43412504275641744522;-1.6995135592603449748 -0.10179625116242695115 -0.030970845130107397397;1.18746494466422714 -0.59880461792312300595 -1.1870095935108642138;-1.1177294729663582729 -0.71763704958171159465 -0.761381577295898615;1.1461828220630536634 0.54079951110532031855 1.4140325225441072732;-0.05776816055407181516 0.099193170827360052644 -0.34682867402514866439;0.30449944352733965269 -0.11915985047634622407 -0.025089085035052340056];
LW4_1 = [-1.1924774882891457928 -0.080750540574112184 0.39531827425321036662;-1.4557574172181302341 -0.29500130671642327274 0.53314001811566025246;0.42444459995348099435 -0.39115160020998701595 -1.3187171435533575625;-0.016107522995718548398 0.28710139793662226015 0.94565551207608722351;1.6393954595748290171 0.067282216549296530728 -0.67133526890481276528;0.35660777474423305256 0.16576239669846581926 0.75414376903534030561;-0.27167299036994668748 0.057049356223185805626 0.023164902392660970815;0.033694877708316375853 0.26019442533159203856 0.32972881316670288321];
LW4_2 = [-0.89044263335505358103 1.7857266309311063956 -0.20362105122086490705 0.73617186674251677836 -0.02006942169590979208;0.41046957893229574221 0.50091865524774392693 -0.092266783326542714527 -0.58040756413146277204 -3.5212370120872824586;0.10063989833849504296 0.27549637232264501119 0.54452613270504024445 -0.72152885469105676464 -0.29554237782907388787;0.12369246087703228421 -0.50221643448411978916 0.79615369607795605233 -3.1784361869704160775 -0.58257935344400846311;-0.24808211790223086424 -0.29060187726668790242 0.57653168666196585868 -1.4390780008371599763 1.8976192784324494855;-0.0032685007537892069723 -3.7432106287949307166 -0.96989326785564600186 -1.1733336467841242179 0.31274895549836134734;-0.0722087920326929672 2.5899031416571092201 -0.084818789717929443661 2.8165958010894929231 0.3660539646077772824;-0.26422656206751055086 -0.12108666752852226267 -0.37952079720622744485 1.2191515810303117373 1.4927406846393758144];
LW4_3 = [-0.78141513898579717523 -0.60252675962724278058 -0.21747160486586150641 -0.87987637167515309056 0.36717897614193878431 -0.11346561916828440397 0.77655484220516579619 -0.3041918690825908822;-1.1221475277085786182 -1.1747921286569982247 -0.59248159950665635343 0.8076242221352275541 0.30370423301399007698 -0.0023666619509359904799 -0.65757935513075116418 0.87683238380610672991;0.6389297536631527441 2.108367576616344774 1.3528632416122559068 1.3760262415564603611 3.2282022609284357628 1.5815046318753274157 0.48242724985197871224 2.7952685899437512695;1.5267251576355012066 -1.4908902695282850726 -1.1971879669888745301 1.8202599047922407571 -5.2674366010757092127 -1.7671577917861527318 1.170373531302086656 0.23269335983130756684;1.554486881170566992 1.3751184397465645581 0.687395023903577429 3.4899773285244122256 -0.2743434655138835554 0.31624155189654229448 1.2029626333444243258 0.87382308810015241196;-0.89693045187031728016 -0.95825791636400392548 -0.63224134753405603071 -2.8622570023441666898 -0.44677016394690077794 -0.18497796542597411129 -1.7695731704269093143 -2.9964208857386247509;-0.69743914209053503583 -0.20708113888640075628 -0.023976685954911078347 -2.6799349484542358546 0.20953977182685434855 -0.26902392801337632333 0.26004687784703239828 -0.15276728405280487477;-0.056796158509969267569 -0.43473664349181428967 -0.28683967903450441339 0.8849268825106868519 -0.86254708712372174517 -0.53063445600562531013 -0.12788714760774777535 -1.7640551949888176875];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [182.206800487484;5.85503115269372;2.52831436539074;5.35104689931391;15.9229077269538;4.32120644350272;3.11212720893149;2.92160715036588];
y1_step1.xoffset = [0;1.01283162009754e-06;0;0;0.00964536350239163;0;0;0];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + IW2_1*xp1 + LW2_1*a1);

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + IW3_1*xp1 + LW3_1*a1 + LW3_2*a2);

% Layer 4
a4 = repmat(b4,1,Q) + IW4_1*xp1 + LW4_1*a1 + LW4_2*a2 + LW4_3*a3;

% Output 1
y1 = mapminmax_reverse(a4,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
