function [y1] = REFORMER_mf(x1)
%REFORMER_MF neural network simulation function.
%
% Auto-generated by MATLAB, 18-Jan-2022 15:47:22.
% 
% [y1] = REFORMER_mf(x1) takes these arguments:
%   x = 3xQ matrix, input #1
% and returns:
%   y = 11xQ matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-1.72088863440429;-1.74612024559196;-1.70833230753895];
x1_step1.gain = [0.57655385026248;0.577464051740462;0.584187940642936];
x1_step1.ymin = -1;

% Layer 1
b1 = [0.5692116528459921776;-0.59332541761675838821;1.2547861268874929142];
IW1_1 = [0.091773089669542312619 0.125660065609567273 0.96461349011788588559;-0.080035197326449231126 0.071641790422901197033 0.0064848365276949761563;0.2666432159774628774 0.17644218335963465782 -0.039317377618811322204];

% Layer 2
b2 = [0.57859231243242503773;17.824235263666110995;4.0588527724523792983;3.6716775810529131974;4.4429173441757905394;2.4438826445728953907;0.89762777265835436147];
LW2_1 = [-0.047269178874545569879 -1.9653877803089079279 -3.8843680759383416579;-1.6718340071212718367 5.5805508157390582014 -18.93103278500044695;0.45278919161324387987 -0.31247723048091174958 -5.7164599532062485565;-0.023268799975568073973 0.8284200981886685744 -4.6556227634087559153;0.61027548854880531159 0.53623839509540460746 -7.9007635752197487022;-0.56158497926587147564 -0.78142009196617900901 -5.2689110881794709584;-1.5633389413600378148 4.7852081178838332676 5.550421074190137638];

% Layer 3
b3 = [1.4276046164049895904;11.445823735552931311;7.7162874634313194377;-2.5096590615733904706;0.25753371391607038365;3.6410983886276588883;7.5343237469111477012;13.468558624374725952;-2.7756342104758600087;-6.7956793087906497419;-1.8790664212178722625];
LW3_2 = [12.291482452407363368 -7.1474123749559854701 -6.798485220244502969 26.685391200072551499 -13.596526068403605336 -0.35088005037423564136 -0.020305736460049829406;15.044036553536296097 -0.050821876988415781717 0.089912172557732900069 -1.4548079310244435014 -0.019267679498177085751 1.0329644713537868839 0.46110808675843550919;13.387282549675857624 0.10426022897837126935 -0.29753964611779454286 -2.4466374174416278819 -1.8557521988231275856 0.58835009330475329659 0.3726946485881379445;13.946416886716354711 0.084913376199069551253 -1.0573027033092683435 0.50763582435849630148 -8.6322843486288167725 -6.3399332772997416541 -0.10857882008578824407;2.7030994397398342421 0.041370329170272480968 -1.584523963274355518 3.7811278359978244268 0.053216618879372713791 -3.3692283190150207339 0.94198403745771075446;9.0340543908853714328 -1.6117262265893514961 -0.59413208542990947336 -1.0975393498950427595 5.1823579118227574014 -4.4332666283592887524 1.8944165984223055865;1.245663657649716427 -2.7655511032445661002 0.48050924602677808073 -5.9493641212232910576 2.741477509309583116 10.434034556210443512 -1.2323767621275392159;17.369014490323394284 -0.013820120340300485681 0.70857231018490840491 -3.4516172057201552903 0.12443450682362566795 1.3384411948554868488 0.41675223936092631316;-20.981470100787458222 1.6821655946603237819 1.6344472383534622839 -1.1914843920644015984 -4.0578657003561922068 15.536804354317226284 -3.1617367814947980875;-6.3008517930816294594 0.019308037843566206587 -1.2957112534234571655 3.2581086646561736586 1.1373599038897563851 -2.3989990029630634538 1.0367176709939012191;-0.31321539886033383793 0.048451954752226474021 -1.414899364578281693 3.4199039361197147713 0.39889214738072692468 -2.8533546858537492952 0.85392930699606761635];

% Layer 4
b4 = [-1.1728979653964171082;2.9577551019043561986;-1.2012093358555002709;0.29845789288599622324;3.9000458244257814044;-3.9660714035458646265;2.2845569712388802408;-3.9654844863613298855;-3.9654844863545863909;0.99202714881061282437;-3.9654844863716305348];
LW4_3 = [-3.6153614262809896651 -4.3412873817707904323 4.9159052642282592416 1.0047473153637731524 -5.1718011345999492789 -3.465324579570726371 1.0193268521744616173 3.1331080295986155626 -0.87339530865619363631 -1.6124184152838134665 6.298372539806322834;7.2750862374594662541 -3.9285325960026611369 -2.9329459300022144852 -1.7896243904455950702 7.2868600679108004314 -2.5824386549650073519 0.43905666162505307959 3.595146020388797492 -3.2258507318536535635 1.9677446410862058368 -9.8873975825844357956;-6.6539491310780229938 -3.4128072518237884125 2.1383099015964042167 5.2147337387601302439 -1.3674608930066451951 8.4997876527460682894 -2.0935106929554949673 2.7496388375074394261 6.5537403649966377017 -0.43493012424424665197 1.9533857562409815412;0.87014681306722163612 -6.099649499268839925 -4.0604371741485589808 0.92434257947312326031 1.9780795845776215636 -0.88204616882192499183 0.0016786135417290357855 8.2668386823842592293 -2.3221495621572976198 -0.64114904826150409534 -1.6206993976216306219;1.0172080119666311315 2.4019975594508560235 5.1022023271158332136 -0.61614953980800302169 1.2780385054557337199 4.1910274844186128362 -0.84621403918386495224 -1.6629597010867032125 4.6001226875865990351 0.47753573793396469904 -1.676043865792265164;-0.071856846950761790738 8.1873842199950583876 -2.0012840795150985684 -1.3526755462629886928 -1.0586310069221938068 -0.4542767390665842786 0.14033778505604296849 -10.073052088107298019 -0.45966118721991278129 0.9579423123521262351 0.71935801607658522716;0.010102469592717541053 -8.9188565528824810258 2.4425616353408461379 1.882590345402875176 1.4671362080575864884 -0.28078319330358797457 0.030412069786889088518 8.2529325495976433302 0.080145343123099774263 -0.11775158382893419207 -2.1775637867537955827;-0.072155902977065269899 8.1900848000737820342 -2.0008860855343910679 -1.3514112561688442771 -1.0574949068457575319 -0.45256588316528784111 0.14019466658633950029 -10.076411930223704516 -0.45821666083842776951 0.95742264952816291679 0.71875421141030737537;-0.072155902969994342722 8.1900848000734676191 -2.0008860855342236462 -1.3514112561686357772 -1.0574949068496541926 -0.45256588317979962177 0.14019466658797533065 -10.076411930223153846 -0.4582166608499901872 0.95742264952719369209 0.71875421141507378486;0.058854820185721537507 -0.10962846649029636681 -0.19788514671311449589 -0.33229865100152300439 -0.25464825114107936255 0.66582544463800918955 -0.15793760435752035587 2.4525808985274877294 0.36340964346159415621 -0.80078554775929589038 1.1788567155263582897;-0.072155902986355061057 8.1900848000794734816 -2.0008860855349617225 -1.3514112561688356173 -1.057494906842736615 -0.45256588316991108734 0.14019466658710050266 -10.076411930229951963 -0.45821666084222550941 0.95742264952867617289 0.71875421140619710769];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [0.410237477840287;0.328539917968194;0.434387858135237;0.32918222524108;0.19705019492722;0.468549716113992;0.442324060630254;0.468508029768654;0.468508029768654;0.22733864080485;0.468508029768657];
y1_step1.xoffset = [-1.76245470873731;-1.42873239463767;-2.21531876422423;-1.5666031367543;-0.645971822276246;-2.45167796518232;-1.79875917070236;-2.45222424783102;-2.45222424783103;-1.05826780766931;-2.45222424783103];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = tansig_apply(repmat(b2,1,Q) + LW2_1*a1);

% Layer 3
a3 = tansig_apply(repmat(b3,1,Q) + LW3_2*a2);

% Layer 4
a4 = repmat(b4,1,Q) + LW4_3*a3;

% Output 1
y1 = mapminmax_reverse(a4,y1_step1);
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
